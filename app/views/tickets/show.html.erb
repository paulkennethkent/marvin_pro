<% @page_title = "Tickets - Show" %>
<%- model_class = Ticket -%>
<div class="page-header">
  <h1><%=t '.title', :default => model_class.model_name.human.titleize %></h1>
</div> <!-- end of page header -->
<div class="row">
  <div class="span6">
    <h4>Customer details</h4>
    <dl>
      <dt><strong><%= model_class.human_attribute_name(:name) %>:</strong></dt>
      <dd><%= @ticket.customer.name if @ticket.customer %></dd>
      <dt><strong><%= model_class.human_attribute_name(:email) %>:</strong></dt>
      <dd><%= mail_to @ticket.customer.email, nil,  cc:    " ", subject: "Case number # #{@ticket.id}", body: "Hello" if @ticket.customer %></dd>
      <dt><strong><%= model_class.human_attribute_name(:phone) %>:</strong></dt>
      <dd><%= @ticket.customer.phone if @ticket.customer%></dd>
    </dl>
  </div> <!-- end of span6 -->
  <div class='span6 pullright'>
    <h4>Product details</h4>
    <dl>
      <dt><strong><%= model_class.human_attribute_name(:product_id) %>:</strong></dt>
      <dd><%= @ticket.product.name %></dd>
      <dt><strong><%= model_class.human_attribute_name(:admin_user_id) %>:</strong></dt>
      <dd><%= @ticket.admin_user.username if @ticket.admin_user %></dd>
    </dl>
  </div> <!-- end of span 6 -->
</div> <!-- end of row -->
<hr />
<h4>Q and A</h4>


<hr />
<h2><%= pluralize(@ticket.notes.size, 'comment') %> found</h2>
<% @ticket.notes.each do |note| %>
  <blockquote>
    <p><%= note.comment %></p>
    <small><%= note.created_at %></small>
    <small><%= note.admin_user.username if note.admin_user %></small>
  </blockquote>
<% end %>

<div class="note comment">
  
  <%= form_for([@ticket, @ticket.notes.build]) do |n| %>
      <%= render(:partial => "note", :locals => {:n => n}) %>  
    <div class="form-actions">
    <%= n.submit nil, :class => 'btn btn-primary' %>
    <%= link_to t('.cancel', :default => t("helpers.links.cancel")), :action => 'index', :class => 'btn btn-danger' %>
  </div>
<% end %>
</div>

<div class="form-actions">
  <%= link_to t('.back', :default => t("helpers.links.back")), :class => 'btn', :action => 'index'  %>
  <%= link_to t('.edit', :default => t("helpers.links.edit")), :class => 'btn', :action => 'edit', :id => @ticket.id %>
  <%= link_to t('.destroy', :default => t("helpers.links.destroy")),
              :method => 'delete',
              :data => { :confirm => t('.confirm', :default => t("helpers.links.confirm", :default => 'Are you sure?')) },
              :class => 'btn btn-danger' %>
</div>